# Ð—Ð°Ð´Ð°Ñ‡Ð° 11.5: Dark Mode

> **Ð¡Ñ‚Ð°Ñ‚ÑƒÑ:** ðŸ“‹ Planned
>
> **Ð¤Ð°Ð¹Ð»Ñ‹:**
> - `apps/client/src/hooks/use-theme.ts`
> - `apps/client/src/components/ui/theme-provider.tsx`
> - `apps/client/src/components/ui/theme-toggle.tsx`

## ÐžÐ±Ð·Ð¾Ñ€

Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ‚Ñ‘Ð¼Ð½Ð¾Ð¹ Ñ‚ÐµÐ¼Ñ‹ Ñ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»ÐµÐ¼ Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸ÐµÐ¼ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð² localStorage.

---

## ðŸŽ¯ Ð¦ÐµÐ»ÑŒ

- Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ñ‚ÐµÐ¼ (light/dark/system)
- ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»ÑŒ Ñ‚ÐµÐ¼
- Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð² localStorage
- CSS Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð´Ð»Ñ Ñ†Ð²ÐµÑ‚Ð¾Ð²
- ÐŸÐ»Ð°Ð²Ð½Ñ‹Ðµ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ñ‹

---

## ðŸ“ ÐŸÐ»Ð°Ð½ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸

### 1) CSS Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð´Ð»Ñ Ñ‚ÐµÐ¼

**Ð’ `apps/client/src/index.css`:**

```css
@import "tailwindcss";

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --primary: 221.2 83.2% 53.3%;
    --primary-foreground: 210 40% 98%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 221.2 83.2% 53.3%;
  }

  .dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --primary: 217.2 91.2% 59.8%;
    --primary-foreground: 222.2 47.4% 11.2%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 224.3 76.3% 48%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    transition: background-color 0.3s, color 0.3s;
  }
}
```

### 2) ThemeProvider

**`apps/client/src/components/ui/theme-provider.tsx`:**

```tsx
import { createContext, useContext, useEffect, useState } from 'react';

type Theme = 'light' | 'dark' | 'system';

interface ThemeContextValue {
  theme: Theme;
  setTheme: (theme: Theme) => void;
  actualTheme: 'light' | 'dark';
}

const ThemeContext = createContext<ThemeContextValue | undefined>(undefined);

export function ThemeProvider({ children }: { children: React.ReactNode }) {
  const [theme, setThemeState] = useState<Theme>('system');
  const [actualTheme, setActualTheme] = useState<'light' | 'dark'>('light');

  useEffect(() => {
    const stored = localStorage.getItem('theme') as Theme;
    if (stored) {
      setThemeState(stored);
    }
  }, []);

  useEffect(() => {
    const root = window.document.documentElement;
    root.classList.remove('light', 'dark');

    let resolved: 'light' | 'dark' = 'light';

    if (theme === 'system') {
      resolved = window.matchMedia('(prefers-color-scheme: dark)').matches
        ? 'dark'
        : 'light';
    } else {
      resolved = theme;
    }

    root.classList.add(resolved);
    setActualTheme(resolved);
  }, [theme]);

  const setTheme = (theme: Theme) => {
    setThemeState(theme);
    localStorage.setItem('theme', theme);
  };

  return (
    <ThemeContext.Provider value={{ theme, setTheme, actualTheme }}>
      {children}
    </ThemeContext.Provider>
  );
}

export const useTheme = () => {
  const context = useContext(ThemeContext);
  if (!context) throw new Error('useTheme must be used within ThemeProvider');
  return context;
};
```

### 3) ThemeToggle ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚

**`apps/client/src/components/ui/theme-toggle.tsx`:**

```tsx
import { useTheme } from './theme-provider';

export function ThemeToggle() {
  const { theme, setTheme, actualTheme } = useTheme();

  return (
    <div className="flex items-center gap-2">
      <button
        onClick={() => setTheme('light')}
        className={`p-2 rounded ${theme === 'light' ? 'bg-gray-200' : ''}`}
        title="Light"
      >
        <Sun />
      </button>
      <button
        onClick={() => setTheme('dark')}
        className={`p-2 rounded ${theme === 'dark' ? 'bg-gray-700' : ''}`}
        title="Dark"
      >
        <Moon />
      </button>
      <button
        onClick={() => setTheme('system')}
        className={`p-2 rounded ${theme === 'system' ? 'bg-gray-200 dark:bg-gray-700' : ''}`}
        title="System"
      >
        <Monitor />
      </button>
    </div>
  );
}
```

---

## âœ… ÐšÑ€Ð¸Ñ‚ÐµÑ€Ð¸Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ

- [ ] ThemeProvider Ð¾Ð±Ñ‘Ñ€Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ
- [ ] useToast hook Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚
- [ ] 3 Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð°: light, dark, system
- [ ] ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»ÑŒ Ð² UI
- [ ] Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð² localStorage
- [ ] ÐŸÐ»Ð°Ð²Ð½Ñ‹Ðµ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ñ‹

---

## ðŸ’¡ ÐŸÐ¾Ð»ÐµÐ·Ð½Ð¾Ðµ

### Ð˜ÐºÐ¾Ð½ÐºÐ¸ Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»Ñ

```tsx
import { Sun, Moon, Monitor } from 'lucide-react';
```

### ÐœÐµÐ´Ð¸Ð°-Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð´Ð»Ñ system

```tsx
useEffect(() => {
  const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');

  const handleChange = () => {
    if (theme === 'system') {
      setActualTheme(mediaQuery.matches ? 'dark' : 'light');
    }
  };

  mediaQuery.addEventListener('change', handleChange);
  return () => mediaQuery.removeEventListener('change', handleChange);
}, [theme]);
```
